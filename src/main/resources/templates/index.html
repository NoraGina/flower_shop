<!DOCTYPE html>
<html lang="en"  xmlns="http://www.w3.org/1999/xhtml"  xmlns:th="https://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Eden Flower Shop Home Page</title>
    <link rel="stylesheet" href="/css/register.css" th:href="@{/css/register.css}">
    <link rel="stylesheet" href="css/main.css" th:href="@{/css/main.css}">
    <link rel="stylesheet" href="css/homePage.css" th:href="@{/css/homePage.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat+Alternates:ital,wght@0,400;1,300;1,400&family=Noto+Sans:ital@0;1&family=Poppins:ital,wght@0,400;1,300;1,400&family=Raleway:ital,wght@0,300;0,400;1,400&family=Roboto:ital,wght@0,400;0,500;1,300;1,400&display=swap">


</head>
<body>

<!--NAVBAR-->
<nav class="navBar">
    <!--FIRST NAVBAR-->
    <div class="firstNavBar">
    <!--LOGO-->
        <div class="logo">
            <a href="" class="logoLink"> <img src="images/forYouLogoWhite.png" th:src="@{images/forYouLogoWhite.png}" alt="Logo missing..."  class="logoImg"></a>
        </div>
        <!--NAV LIST-->
        <ul class="navList" id="naviList">
            <li class="listItem">
                <a href="" th:href="@{/}"><i class="bi bi-house-fill"></i>Home</a>
            </li>
            <li class="listItem">
                <a href=""><i class="bi bi-envelope-fill"></i>Contact me</a>
            </li>
        </ul>

        <div class="userDiv">
            <ul class="userDivList" id="userDivId">
                <li class="userListItem">
                    <a href="" sec:authorize="isAuthenticated()"><i class="bi bi-geo-alt-fill"></i>Adresa de livrare</a>
                    <!--DROPDOWN LIST-->
                    <ul class="dropdownList">
                        <li class="dropdownItem"><a href="" th:href="@{/customer/add/address/form}">Adaugă adresă</a></li>
                        <hr>
                        <li class="dropdownItem"><a href="" th:href="@{/customer/shippingAddresses}">Listă adrese</a></li>
                    </ul>
                </li>
                <li class="userListItem">
                    <a href="#" sec:authorize="isAuthenticated()" th:href="@{/customer/view/cart/form}"><i class="bi bi-cart-fill"></i>Coș</a>
                </li>

                <li class="userListItem">
                    <a href="" th:href="@{/logout}" sec:authorize="isAuthenticated()"><i class="bi bi-box-arrow-left"></i>Logout</a>
                </li>

                <li class="userListItem">
                    <a href=""><i class="bi bi-box-arrow-in-right"></i>Register</a>
                    <!--DROPDOWN LIST-->
                    <ul class="dropdownList">
                        <li class="dropdownItem"><a href="" th:href="@{/login}">LogIn</a></li>
                        <hr>
                        <li class="dropdownItem"><a href="" th:href="@{/customer/registration}">SignUp</a></li>
                    </ul>

                </li>
            </ul>
        </div>

        <!--HAMBURGER MENU-->
        <div class="menu" id="toggleButton">
            <div class="menuLine"></div>
            <div class="menuLine"></div>
            <div class="menuLine"></div>
        </div>
    </div><!--End First Navbar-->

    <!-- STARING FILTER BAR-->
    <div class="filterBar" >
        <div class="textFilter">
            <h4 class="filterHeader">Filtrează produsele</h4>
        </div>
        <div class="container" id="navFilterList">
            <div class="itemContainer">
                <a href="" th:href="@{/available/products}">Produse disponibile</a>
            </div>
            <div class="itemContainer">
                <form class="filterForm" th:action="@{/customer/available/category}" method="get">
                    <select class="selectTxt" name="idCategory">
                        <option value="">Alege categorie</option>
                        <option th:each="category:${categoryList}" th:value="${category.idCategory}" th:text="${category.categoryName}"></option>
                    </select>
                    <button type="submit"><i class="bi bi-binoculars-fill searchIcon" type="button"></i></button>
                </form>
            </div>
            <div class="itemContainer">
                <form class="filterForm" th:action="@{/customer/available/origin}" method="get">
                    <select class="selectTxt" name="origin">
                        <option value="">Alege origine</option>
                        <option th:each="origin:${origins}" th:value="${origin}" th:text="${origin}"></option>
                    </select>
                    <button type="submit">
                    <i class="bi bi-binoculars-fill searchIcon" type="submit"></i>
                    </button>
                </form>
            </div>
            <div class="itemContainer">
                <form class="filterForm" th:action="@{/customer/available/category/origin}" method="get">
                    <label>Produse categorie si origine</label>
                    <select class="selectTxt" name="idCategory">
                        <option value="">Alege categoria</option>
                        <option th:each="category:${categoryList}" th:value="${category.idCategory}" th:text="${category.categoryName}"></option>
                    </select>
                    <select class="selectTxt" name="origin" id="origin">
                        <option value="">Alege origine</option>
                        <option th:each="origin:${origins}" th:value="${origin}" th:text="${origin}"></option>
                    </select>
                    <button type="submit">
                    <i class="bi bi-binoculars-fill searchIcon" type="button"></i>
                    </button>
                </form>
            </div>


        </div>
        <div class="menuFilter" id="toggleFilterButton">
            <div class="menuFilterLine"></div>
            <div class="menuFilterLine"></div>
            <div class="menuFilterLine"></div>
        </div>
    </div><!-- ENDING FILTER BAR-->
<!--END NAV-->
</nav>

<div class="titleBox">
    <h1>Lorem, ipsum dolor sit amet consectetur adipisicing.</h1>

    <div class="messageContainer" th:if="${customer != null}">
        <span>Bine ai venit </span><span  th:text="${customer.fullName}" class="messageTxt"></span><span> !</span>
    </div>
    <h3 class="message-txt" th:text="${message}"></h3>
    <div class="logDiv" th:if="${param.logout}">

        <span>Ai fost deconectat.</span>
    </div>
</div>

<!--CARUSEL-->
<div class="slideshowContainer">

    <div class="mySlides fade">
        <div class="numbertext">1 / 3</div>
        <img class="slideImg" src="images/banner_ghivece-min.png"  th:src="@{images/banner_ghivece-min.png}" style="width:100%" alt="picture missing...">
    </div>

    <div class="mySlides fade">
        <div class="numbertext">2 / 3</div>
        <img class="slideImg" src="images/banner_flori-min.png"  th:src="@{images/banner_flori-min.png}" style="width:100%" alt="picture missing..." >
    </div>

    <div class="mySlides fade">
        <div class="numbertext">3 / 3</div>
        <img class="slideImg" src="images/banner_aranjamente-min.png" th:src="@{images/banner_aranjamente-min.png}" style="width:100%" alt="picture missing...">
    </div>

</div><!--END CARUSEL-->

<!--MAIN-->
<main th:if="!${#lists.isEmpty(products)}">

    <div class="column" th:each="product:${products}">
        <div class="imageBox">
            <img  th:src="*{'data:image/jpg;base64,'+ product.imageAsString}"  alt="picture missing..."  class="imgProd"/>
        </div>
        <h3  th:text="${product.productName}"></h3>
        <div class="priceDiv">
            <label class="priceInfo">Pret</label>
            <strong><span th:text="${product.price}"> </span></strong><span> Lei</span>
        </div><!--End PRICE DIV-->
        <div class="stockDiv" th:if="${product.stock == 0}">
            <em><span>Produs indisponibil</span></em>
        </div>
        <div class="stockDiv" th:unless="${product.stock == 0}">
            <em><span>Produs disponibil</span></em>
        </div>

        <div class="btnBox">
            <button class="openmodal" onclick="openMyModal()">Mai multe informații</button>
            <div class="by-container" th:if="${product.stock != 0}">
                <button class="byBtn" type="submit">
                    <a href="#" th:href="@{/by/product/{idProduct}(idProduct=${product.idProduct})}"  th:disabled="${product.stock == 0}">
                        <i class="fas fa-cart-arrow-down">Adauga</i>
                    </a>
                </button>
            </div><!--End by-container-->
        </div><!--***End btnBox***-->

        <div class="modal myModal">
            <!-- The Modal -->
            <div class="modalContent">
                <!-- Modal content -->
                <span class="close">&times;</span>
                <h3 th:text="${product.productName}"></h3>
                <div class="row">
                    <div class="col">
                        <div class="imgModal">
                          <img class="modalImg" th:src="*{'data:image/jpg;base64,'+ product.imageAsString}"  alt="Picture missing..."/>
                        </div>
                    </div><!--End col-->

                    <div class="col">
                        <div class="myDiv">
                            <label>Preț:&nbsp;</label>
                            <strong><span th:text="${product.price}"></span></strong><em><span> Lei</span></em>
                        </div>

                        <div class="myDiv">
                            <label>Descriere produs</label>
                            <strong><span  th:text="${product.description}"></span></strong>
                        </div>

                        <div class="myDiv">
                            <label>Origine: </label><strong><span th:text="${product.origin}"></span></strong>
                        </div>

                        <div class="stock" th:if="${product.stock == 0}">
                            <em><span>Produs indisponibil </span></em>
                        </div>

                        <div class="stock" th:unless="${product.stock == 0}">
                            <em><span>Produs disponibil </span></em>
                        </div>
                    </div><!--End Col-->
                </div><!--END row-->
                <div class="byButton">
                    <button class="modalByBtn">
                        <a href="#" th:href="@{/by/product/{idProduct}(idProduct=${product.idProduct})}"  th:disabled="${product.stock == 0}">
                            <i class="bi bi-cart-plus-fill">Adaugă în coș</i></a></button>
                </div>
            </div><!--**END Modal content-->
        </div><!--End MODAl myModal-->

    </div><!--END COLUMN-->
    <div th:if="${#lists.isEmpty(products)}">
        You don't have any products
    </div>

</main>
<script>
     /* TOGGLE FILTER NAVBAR HAMBURGER */
                      const filterToggleButton=document.querySelector('#toggleFilterButton');
                      const navFilterList = document.querySelector('#navFilterList');
                      filterToggleButton.addEventListener('click', ()=>{
                          navFilterList.classList.toggle('filterActive');
                      })
          /* TOGGLE  NAVBAR HAMBURGER */
          const toggleButton = document.querySelector('#toggleButton');
          const naviList = document.querySelector('#naviList');
          const userDivId = document.querySelector('#userDivId')
           toggleButton.addEventListener('click', () => {
                naviList.classList.toggle('active');
                userDivId.classList.toggle('active');
            })

    /*Function to open and close Modal*/
    function openMyModal(){
       let modals = document.querySelectorAll('.modal.myModal')
              // Get the button that opens the modal
        let btns = document.querySelectorAll('.openmodal');
        let spans = document.querySelectorAll(".close");
            for (let i = 0; i < btns.length; i++) {
                btns[i].onclick = function () {
                    modals[i].classList.remove('closeModal');
                    modals[i].classList.add('showModal')
                }
            }
            for (let i = 0; i < spans.length; i++) {
                spans[i].onclick = function () {
                    modals[i].classList.remove('showModal');
                    modals[i].classList.add('closeModal');
                }
            }
    }

    /* *** CARUSEL **** */
  let slideIndex = 0;
      showSlides();

      function showSlides() {
        let i;
        let slides = document.getElementsByClassName("mySlides");

        for (i = 0; i < slides.length; i++) {
          slides[i].style.display = "none";
        }
        slideIndex++;
        if (slideIndex > slides.length) {slideIndex = 1}

        slides[slideIndex-1].style.display = "block";

        setTimeout(showSlides, 3000); // Change image every 2 seconds
      }
</script>

</body>
</html>